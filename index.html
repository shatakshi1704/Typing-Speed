<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Speed Meter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-color: #323437;
            --text-color: #d1d0c5;
            --text-secondary: #646669;
            --accent-color: #e2b714;
            --error-color: #ca4754;
            --correct-color: #e2b714;
            --container-bg: #2c2e31;
            --border-color: #646669;
        }

        [data-theme="light"] {
            --bg-color: #f5f5f5;
            --text-color: #2c2e31;
            --text-secondary: #646669;
            --accent-color: #ff6b35;
            --error-color: #ca4754;
            --correct-color: #4caf50;
            --container-bg: #ffffff;
            --border-color: #e0e0e0;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            margin-bottom: 40px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: var(--accent-color);
        }

        .theme-toggle {
            background: none;
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .container {
            max-width: 1200px;
            width: 100%;
            background: var(--container-bg);
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 40px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--accent-color);
            display: block;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .text-display {
            font-size: 24px;
            line-height: 1.6;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--bg-color);
            border-radius: 8px;
            min-height: 200px;
            position: relative;
            overflow-wrap: break-word;
        }

        .char {
            position: relative;
        }

        .char.correct {
            color: var(--correct-color);
        }

        .char.incorrect {
            color: var(--error-color);
            background-color: rgba(202, 71, 84, 0.2);
        }

        .char.current {
            background-color: var(--accent-color);
            color: var(--bg-color);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .input-field {
            width: 100%;
            padding: 20px;
            font-size: 18px;
            font-family: inherit;
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-color);
            outline: none;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            border-color: var(--accent-color);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 24px;
            background: var(--accent-color);
            color: var(--bg-color);
            border: none;
            border-radius: 4px;
            font-family: inherit;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.secondary {
            background: transparent;
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }

        .btn.secondary:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .results {
            display: none;
            text-align: center;
            margin-top: 30px;
            padding: 30px;
            background: var(--bg-color);
            border-radius: 8px;
        }

        .results.show {
            display: block;
        }

        .results h2 {
            color: var(--accent-color);
            margin-bottom: 20px;
            font-size: 28px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .result-item {
            padding: 20px;
            background: var(--container-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .result-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-color);
        }

        .result-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        @media (max-width: 768px) {
            .stats {
                flex-direction: column;
                gap: 20px;
            }

            .text-display {
                font-size: 20px;
                padding: 20px;
            }

            .container {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">TypeSpeed</div>
        <button class="theme-toggle" id="themeToggle">🌙</button>
    </div>

    <div class="container">
        <div class="stats">
            <div class="stat">
                <span class="stat-value" id="wpm">0</span>
                <div class="stat-label">WPM</div>
            </div>
            <div class="stat">
                <span class="stat-value" id="accuracy">100%</span>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat">
                <span class="stat-value" id="time">60</span>
                <div class="stat-label">Time</div>
            </div>
        </div>

        <div class="text-display" id="textDisplay"></div>

        <input type="text" class="input-field" id="inputField" placeholder="Start typing to begin..." autocomplete="off" spellcheck="false">

        <div class="controls">
            <button class="btn" id="resetBtn">Reset</button>
            <button class="btn secondary" id="newTextBtn">New Text</button>
        </div>

        <div class="results" id="results">
            <h2>Test Complete!</h2>
            <div class="results-grid">
                <div class="result-item">
                    <div class="result-value" id="finalWpm">0</div>
                    <div class="result-label">Words Per Minute</div>
                </div>
                <div class="result-item">
                    <div class="result-value" id="finalAccuracy">100%</div>
                    <div class="result-label">Accuracy</div>
                </div>
                <div class="result-item">
                    <div class="result-value" id="finalChars">0</div>
                    <div class="result-label">Characters</div>
                </div>
                <div class="result-item">
                    <div class="result-value" id="finalErrors">0</div>
                    <div class="result-label">Errors</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class TypingTest {
            constructor() {
                this.sentences = [
                    "The quick brown fox jumps over the lazy dog.",
                    "Programming is the art of telling another human being what one wants the computer to do.",
                    "In the middle of difficulty lies opportunity.",
                    "The only way to do great work is to love what you do.",
                    "Life is what happens to you while you're busy making other plans.",
                    "Success is not final, failure is not fatal: it is the courage to continue that counts.",
                    "The best time to plant a tree was 20 years ago. The second best time is now.",
                    "Your time is limited, so don't waste it living someone else's life.",
                    "Innovation distinguishes between a leader and a follower.",
                    "The future belongs to those who believe in the beauty of their dreams.",
                    "It is during our darkest moments that we must focus to see the light.",
                    "The only impossible journey is the one you never begin.",
                    "Happiness is not something ready made. It comes from your own actions.",
                    "The greatest glory in living lies not in never falling, but in rising every time we fall.",
                    "Do not go where the path may lead, go instead where there is no path and leave a trail.",
                    "Technology is a useful servant but a dangerous master.",
                    "The art of programming is the skill of controlling complexity.",
                    "Code is poetry written in a language that machines can understand.",
                    "Every expert was once a beginner. Every pro was once an amateur.",
                    "The best way to predict the future is to create it yourself."
                ];

                this.currentText = '';
                this.currentIndex = 0;
                this.startTime = null;
                this.isActive = false;
                this.errors = 0;
                this.totalChars = 0;
                this.timer = null;
                this.timeLeft = 60;

                this.elements = {
                    textDisplay: document.getElementById('textDisplay'),
                    inputField: document.getElementById('inputField'),
                    wpm: document.getElementById('wpm'),
                    accuracy: document.getElementById('accuracy'),
                    time: document.getElementById('time'),
                    resetBtn: document.getElementById('resetBtn'),
                    newTextBtn: document.getElementById('newTextBtn'),
                    results: document.getElementById('results'),
                    finalWpm: document.getElementById('finalWpm'),
                    finalAccuracy: document.getElementById('finalAccuracy'),
                    finalChars: document.getElementById('finalChars'),
                    finalErrors: document.getElementById('finalErrors'),
                    themeToggle: document.getElementById('themeToggle')
                };

                this.init();
            }

            init() {
                this.generateNewText();
                this.setupEventListeners();
                this.setupTheme();
            }

            setupEventListeners() {
                this.elements.inputField.addEventListener('input', (e) => this.handleInput(e));
                this.elements.resetBtn.addEventListener('click', () => this.reset());
                this.elements.newTextBtn.addEventListener('click', () => this.generateNewText());
                this.elements.themeToggle.addEventListener('click', () => this.toggleTheme());
                
                // Focus input field when clicking anywhere
                document.addEventListener('click', () => {
                    this.elements.inputField.focus();
                });
            }

            setupTheme() {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                document.documentElement.setAttribute('data-theme', savedTheme);
                this.elements.themeToggle.textContent = savedTheme === 'dark' ? '🌙' : '☀️';
            }

            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                this.elements.themeToggle.textContent = newTheme === 'dark' ? '🌙' : '☀️';
            }

            generateNewText() {
                const randomSentences = [];
                const numSentences = Math.floor(Math.random() * 3) + 2; // 2-4 sentences
                
                for (let i = 0; i < numSentences; i++) {
                    const randomIndex = Math.floor(Math.random() * this.sentences.length);
                    randomSentences.push(this.sentences[randomIndex]);
                }
                
                this.currentText = randomSentences.join(' ');
                this.reset();
            }

            addMoreText() {
                const randomIndex = Math.floor(Math.random() * this.sentences.length);
                this.currentText += ' ' + this.sentences[randomIndex];
                this.displayText();
            }

            reset() {
                this.currentIndex = 0;
                this.startTime = null;
                this.isActive = false;
                this.errors = 0;
                this.totalChars = 0;
                this.timeLeft = 60;
                
                this.elements.inputField.value = '';
                this.elements.inputField.disabled = false;
                this.elements.wpm.textContent = '0';
                this.elements.accuracy.textContent = '100%';
                this.elements.time.textContent = '60';
                this.elements.results.classList.remove('show');
                
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }
                
                this.displayText();
            }

            displayText() {
                const textArray = this.currentText.split('');
                let displayHTML = '';
                
                textArray.forEach((char, index) => {
                    let className = '';
                    
                    if (index < this.currentIndex) {
                        className = this.elements.inputField.value[index] === char ? 'correct' : 'incorrect';
                    } else if (index === this.currentIndex) {
                        className = 'current';
                    }
                    
                    displayHTML += `<span class="char ${className}">${char === ' ' ? '&nbsp;' : char}</span>`;
                });
                
                this.elements.textDisplay.innerHTML = displayHTML;
            }

            handleInput(e) {
                const value = e.target.value;
                
                if (!this.isActive && value.length > 0) {
                    this.startTest();
                }
                
                this.currentIndex = value.length;
                this.totalChars = Math.max(this.totalChars, this.currentIndex);
                
                // Add more text if user is getting close to the end
                if (this.currentIndex > this.currentText.length - 50) {
                    this.addMoreText();
                }
                
                // Count errors
                this.errors = 0;
                for (let i = 0; i < value.length; i++) {
                    if (value[i] !== this.currentText[i]) {
                        this.errors++;
                    }
                }
                
                this.displayText();
                this.updateStats();
                
                // Only end test when timer runs out, not when text is complete
                // if (value === this.currentText) {
                //     this.endTest();
                // }
            }

            startTest() {
                this.isActive = true;
                this.startTime = Date.now();
                
                this.timer = setInterval(() => {
                    this.timeLeft--;
                    this.elements.time.textContent = this.timeLeft;
                    
                    if (this.timeLeft <= 0) {
                        this.endTest();
                    }
                }, 1000);
            }

            updateStats() {
                if (!this.startTime) return;
                
                const timeElapsed = (Date.now() - this.startTime) / 1000 / 60; // in minutes
                const wordsTyped = this.currentIndex / 5; // 5 characters = 1 word
                const wpm = Math.round(wordsTyped / timeElapsed) || 0;
                const accuracy = this.totalChars > 0 ? Math.round(((this.totalChars - this.errors) / this.totalChars) * 100) : 100;
                
                this.elements.wpm.textContent = wpm;
                this.elements.accuracy.textContent = accuracy + '%';
            }

            endTest() {
                this.isActive = false;
                this.elements.inputField.disabled = true;
                
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }
                
                // Calculate final stats
                const timeElapsed = (Date.now() - this.startTime) / 1000 / 60;
                const wordsTyped = this.currentIndex / 5;
                const finalWpm = Math.round(wordsTyped / timeElapsed) || 0;
                const finalAccuracy = this.totalChars > 0 ? Math.round(((this.totalChars - this.errors) / this.totalChars) * 100) : 100;
                
                // Display results
                this.elements.finalWpm.textContent = finalWpm;
                this.elements.finalAccuracy.textContent = finalAccuracy + '%';
                this.elements.finalChars.textContent = this.currentIndex;
                this.elements.finalErrors.textContent = this.errors;
                this.elements.results.classList.add('show');
            }
        }

        // Initialize the typing test
        new TypingTest();
    </script>
</body>
</html>